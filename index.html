<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>QC Inspection Checklist</title>

  <!-- Include html2pdf -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.2/html2pdf.bundle.min.js"
    integrity="sha512-MpDFIChbcXl2QgipQrt1VcPHMldRILetapBl5MPCA9Y8r7qvlwx1/Mc9hNTzY+kS5kX6PdoDq41ws1HiVNLdZA=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- Include SMTP.js -->
  <script src="https://smtpjs.com/v3/smtp.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
    }
    input, textarea, select {
      width: 100%;
      margin-top: 8px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 3px;
    }
    label {
      margin-top: 12px;
      font-weight: bold;
      display: block;
    }
    .btn {
      margin-top: 20px;
      padding: 10px;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div class="container" id="pdfContent">

  <h1 style="text-align:center;">QC Inspection Checklist</h1>

  <form id="qcForm">

    <!-- Example fields (replace with your actual fields) -->
    <label for="inspectorName">Inspector Name</label>
    <input type="text" id="inspectorName" name="inspectorName"/>

    <label for="inspectionDate">Date</label>
    <input type="date" id="inspectionDate" name="inspectionDate"/>

    <label for="location">Location</label>
    <input type="text" id="location" name="location"/>

    <label for="findings">Findings</label>
    <textarea id="findings" name="findings" rows="4"></textarea>

    <label for="remarks">Remarks</label>
    <textarea id="remarks" name="remarks" rows="4"></textarea>

    <button type="button" class="btn" onclick="handleSubmit()">Submit</button>

  </form>

  <p id="status"></p>

</div>

<script>
async function handleSubmit() {
  document.getElementById('status').textContent = "Generating PDF...";

  // Generate PDF
  const element = document.getElementById('pdfContent');
  const opt = {
    margin:       [10,10,10,10],
    filename:     'QC-Inspection.pdf',
    image:        { type: 'jpeg', quality: 0.98 },
    html2canvas:  { scale: 2 },
    jsPDF:        { unit: 'pt', format: 'a4', orientation: 'portrait' }
  };

  html2pdf().from(element).set(opt).outputPdf('datauristring')
    .then(function(pdfAsString) {
      sendEmail(pdfAsString);
    });
}

function sendEmail(pdfString) {
  document.getElementById('status').textContent = "Sending email...";

  Email.send({
    SecureToken: "YOUR_SMTPJS_SECURE_TOKEN_HERE",
    To: 'saleh.shaikh@cspadt.ae',
    From: "no-reply@yourdomain.com",
    Subject: "New QC Inspection Submission",
    Body: "Attached is the QC inspection checklist filled by the user.",
    Attachments: [
      {
        name: "QC-Inspection.pdf",
        data: pdfString
      }
    ]
  }).then(
    message => {
      document.getElementById('status').textContent = "Submitted! Email sent.";
    }
  );
}
</script>

</body>
</html>
