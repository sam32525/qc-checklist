<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quay Crane (QC) Inspection Checklist - Complete Form</title>
  <style>
    /* I HAVE KEPT YOUR EXACT CSS FROM THE UPLOADED FILE */
    body{
      font-family: Arial, Helvetica, sans-serif;
      background:#f4f6f8;
      padding:20px;
      color:#000;
    }
    .page{
      max-width: 1200px;
      margin:auto;
      background:#fff;
      border:1px solid #000;
      padding:18px;
    }

    .header{
      margin:6px 0 18px;
      text-align:center;
    }
    .header .org{
      font-size:18px;
      font-weight:700;
      color:#6b6b6b;
      text-align:left;
    }
    .header .title{
      font-size:15px;
      font-weight:700;
      text-decoration:underline;
      margin-top:10px;
      text-align:center;
    }

    .meta{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
      margin: 14px 0 12px;
    }
    .field label{
      font-size:12px;
      font-weight:700;
      display:block;
      margin-bottom:4px;
    }
    input[type="text"], input[type="date"], input[type="time"], select, textarea{
      width:100%;
      border:1px solid #666;
      border-radius:4px;
      padding:6px;
      font-size:13px;
    }
    
    .section-title{
      text-align:center;
      font-weight:700;
      text-decoration:underline;
      margin:18px 0 8px;
    }

    table{ width:100%; border-collapse:collapse; }
    th, td{ border:1px solid #000; padding:8px; font-size:13px; vertical-align:top; }
    th{ background:#e6e6e6; }
    
    .photo-cell{
      border:1px dashed #777;
      padding:6px;
      text-align:center;
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .thumb{
      height:110px;
      background:#fff;
      border:1px solid #bbb;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .thumb img{ width:100%; height:100%; object-fit:contain; }

    /* --- CSP COLOR THEME FROM YOUR FILE --- */
    :root{
      --csp-blue:#0b4f8a;
      --csp-light:#e8f1fb;
      --csp-grey:#f2f2f2;
      --csp-dark:#1f2937;
    }

    .header-with-logo{
      border-bottom:3px solid var(--csp-blue);
      padding-bottom:10px;
      margin-bottom:12px;
      display:grid;
      grid-template-columns: 1fr auto;
      align-items:center;
    }
    .header .org{ color:var(--csp-blue); }
    .section-title{
      background:var(--csp-light);
      border:1px solid var(--csp-blue);
      color:var(--csp-blue);
      padding:6px 10px;
      text-decoration:none;
    }
    
    /* ADDED FOR THE NEW BUTTONS */
    .btn-add { background:var(--csp-blue); color:white; border:none; padding:5px 15px; border-radius:4px; cursor:pointer; margin-bottom:10px; }
    .btn-del { color:red; font-weight:bold; border:none; background:none; cursor:pointer; }

    /* Signatures */
    .sign-grid{ display:grid; grid-template-columns: 1fr 1fr; gap:16px; margin-top:10px; }
    .sigbox{ border:1px solid #000; padding:10px; }
    canvas{ width:100%; height:130px; border:1px solid #000; background:#fff; touch-action:none; }
    
    .footer-table{ width:100%; border-collapse:collapse; margin-top:20px; }
    .footer-table th{ background:var(--csp-blue) !important; color:#fff; }
</style>
</head>
<body>
  <div class="page">
    <div class="header header-with-logo">
      <div class="header-text">
        <div class="org">CSP Abu Dhabi Terminal Environment, Health and Safety Management</div>
        <div class="title">Quay crane (QC) Inspection checklist</div>
      </div>
      <img class="hdr-logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABsUAAAI6CAYAAAB/1kZW..." style="height:75px;">
    </div>

    <div class="meta">
      <div class="field"><label>Date:</label><input type="text" id="autoDate" readonly></div>
      <div class="field"><label>Time:</label><input type="text" id="autoTime" readonly></div>
      <div class="field"><label>Location:</label><input type="text"></div>
      <div class="field"><label>Crane No:</label><input type="text"></div>
    </div>

    <div class="section-title">DETAILED OBSERVATIONS & RECOMMENDATIONS</div>
    
    <button type="button" class="btn-add" onclick="addRow()">+ Add New Observation Row</button>
    
    <table>
      <thead>
        <tr>
          <th style="width:50px;">S/N</th>
          <th>Observation / Defect Found</th>
          <th>Recommendation / Action Taken</th>
          <th style="width:240px;">Photo Evidence</th>
          <th style="width:40px;">Del</th>
        </tr>
      </thead>
      <tbody id="obsBody">
        </tbody>
    </table>

    <div class="section-title">AUTHORIZATION</div>
    <div class="sign-grid">
      <div class="sigbox">
        <label>HSE Inspector Signature</label>
        <canvas id="sig1"></canvas>
        <button onclick="clearSig('sig1')">Clear</button>
      </div>
      <div class="sigbox">
        <label>HSSE Manager Signature</label>
        <canvas id="sig2"></canvas>
        <button onclick="clearSig('sig2')">Clear</button>
      </div>
    </div>

    <div class="footer">
      <table class="footer-table">
        <tr>
          <th>Prepared By</th>
          <th>Reviewed By</th>
          <th>Verified By</th>
        </tr>
        <tr>
          <td><input type="text" placeholder="Name"></td>
          <td><input type="text" placeholder="Name"></td>
          <td><input type="text" placeholder="Name"></td>
        </tr>
      </table>
    </div>
  </div>

<script>
    // AUTO DATE/TIME
    document.addEventListener('DOMContentLoaded', () => {
      const now = new Date();
      document.getElementById('autoDate').value = now.toLocaleDateString('en-GB');
      document.getElementById('autoTime').value = now.toLocaleTimeString('en-GB', {hour:'2-digit', minute:'2-digit'});
      addRow(); // Start with one row
      setupPad('sig1');
      setupPad('sig2');
    });

    // ADD/DELETE ROW LOGIC
    let rowIdx = 0;
    function addRow() {
      rowIdx++;
      const tbody = document.getElementById('obsBody');
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td style="text-align:center;">${rowIdx}</td>
        <td><textarea class="obs-ta"></textarea></td>
        <td><textarea class="rec-ta"></textarea></td>
        <td class="photo-cell">
            <input type="file" accept="image/*" onchange="preview(this)">
            <div class="thumb">Preview</div>
        </td>
        <td><button type="button" class="btn-del" onclick="removeRow(this)">X</button></td>
      `;
      tbody.appendChild(tr);
    }

    function removeRow(btn) {
      btn.closest('tr').remove();
      // Re-index numbers
      const rows = document.querySelectorAll('#obsBody tr');
      rowIdx = 0;
      rows.forEach(r => { rowIdx++; r.cells[0].innerText = rowIdx; });
    }

    function preview(input) {
      const thumb = input.parentElement.querySelector('.thumb');
      const file = input.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = e => { thumb.innerHTML = `<img src="${e.target.result}">`; };
        reader.readAsDataURL(file);
      }
    }

    // SIGNATURE LOGIC
    function setupPad(id) {
      const canvas = document.getElementById(id);
      const ctx = canvas.getContext('2d');
      let drawing = false;
      const getPos = (e) => {
        const rect = canvas.getBoundingClientRect();
        return { x: (e.clientX || e.touches[0].clientX) - rect.left, y: (e.clientY || e.touches[0].clientY) - rect.top };
      };
      canvas.addEventListener('mousedown', (e) => { drawing = true; ctx.beginPath(); const p = getPos(e); ctx.moveTo(p.x, p.y); });
      canvas.addEventListener('mousemove', (e) => { if(!drawing) return; const p = getPos(e); ctx.lineTo(p.x, p.y); ctx.stroke(); });
      window.addEventListener('mouseup', () => drawing = false);
      canvas.addEventListener('touchstart', (e) => { e.preventDefault(); drawing = true; ctx.beginPath(); const p = getPos(e); ctx.moveTo(p.x, p.y); }, {passive:false});
      canvas.addEventListener('touchmove', (e) => { e.preventDefault(); if(!drawing) return; const p = getPos(e); ctx.lineTo(p.x, p.y); ctx.stroke(); }, {passive:false});
    }

    function clearSig(id) {
      const c = document.getElementById(id);
      c.getContext('2d').clearRect(0,0,c.width,c.height);
    }
</script>
</body>
</html>
